define(["jquery","core/log","mod_tutorialbooking/dragdrop-base","core/notification","core/ajax","mod_tutorialbooking/dragdrop-datastore"],function(a,b,c,d,e,f){var g={DATANODE:".tutorial_sessions",DRAGGABLE:".tutorial_session",DRAGAREA:".tutorial_sessions",DROPTARGET:".tutorial_session[draggable=true]",HANDLEELEMENT:".tutorial_session .sectionname",MOVEDOWNCONTROL:".tutorial_session .controls .movedown",MOVEUPCONTROL:".tutorial_session .controls .moveup"},h={STRING:{name:"moveslot",component:"mod_tutorialbooking"}},i=function(){b.debug("Setting up","mod_tutorialbooking/dragdrop"),a(this.SELECTORS.MOVEUPCONTROL).remove(),a(this.SELECTORS.MOVEDOWNCONTROL).remove(),this.globalSetup(),b.debug("Setup completed","mod_tutorialbooking/dragdrop")},j=function(c){b.debug("Dropped element","mod_tutorialbooking/dragdrop");var g=a(c.target).closest(c.data.selectors.DRAGAREA),h={methodname:"mod_tutorialbooking_moveslot",args:{tutorial:k(g),slot:l(f.getDragged()),target:l(f.getTarget())}},i=e.call([h]);i[0].done(function(c){if(c.success)if("before"===c.where){var d="Slot "+h.args.slot+" moved before slot"+h.args.target;b.debug(d,"mod_tutorialbooking/dragdrop"),a("#"+f.getTarget()).before(a("#"+f.getDragged()))}else{var d="Slot "+h.args.slot+" moved after slot"+h.args.target;b.debug(d,"mod_tutorialbooking/dragdrop"),a("#"+f.getTarget()).after(a("#"+f.getDragged()))}}).fail(d.exception)},k=function(b){return a(b).attr("id").substr(9)},l=function(a){return a.substr(5)},m={SELECTORS:a.extend({},c.SELECTORS,g),HANDLE:a.extend({},c.HANDLE,h),drop:j,init:i};return a.extend({},c,m)});